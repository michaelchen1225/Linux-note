# Linux 檔案與目錄管理

## 目錄 & 路徑

### 相對路徑 & 絕對路徑

* **絕對路徑**：「由根目錄 / 寫起」，例如： /usr/share/doc。
  * 優點：最精確的定位，除非打錯字不然不會出錯。
  * 缺點：輸入的字串較長，如果目錄名稱很長，輸入會很麻煩。

  > 善用 bash shell 的 Tab 鍵，可以自動補齊路徑名稱！！


* **相對路徑**：「不是由 / 寫起」，意指『相對於目前工作目錄的路徑！』。例如從 /usr/share/doc 要到 /usr/share/man 底下時，可以寫成： 『cd ../man』這就是相對路徑。
  * 優點：較方便使用，且比較彈性。
  * 缺點：使用前提是你要非常清楚目錄結構，否則容易出錯。

### 執行檔路徑的變數：$PATH

前一章的說明中，我們知到 ls 指令的完整檔名為：/bin/ls (絕對路徑)， 那你會不會覺得很奇怪：
> 『為什麼我可以在任何地方執行/bin/ls這個指令呢？ 』

照理來說，如果你當前的工作目錄**不在** /bin，那只輸入「ls」是一種相對路徑表示法，應該會找不到該指令才對！但是，為什麼我們可以在任何地方執行 ls 呢？這就是因為環境變數「PATH」的幫助。

PATH(一定是大寫)這個變數的內容是由一堆目錄所組成，：

* 每個目錄中間用冒號(:)來隔開
* 有順序之分

在執行一個指令的時候，舉『ls』為例，系統會依照 PATH 的設定，去每個 PATH 「定義的目錄」下搜尋檔名為「ls」的可執行檔，如果在PATH定義的目錄中含有多個檔名為ls的可執行檔，那麼**先搜尋到的同名指令先被執行**。

現在，請下達『echo $PATH』來看看到底有哪些目錄被定義出來了？ echo有『顯示、印出』的意思，而 PATH 前面加的 $ 表示後面接的是變數，所以會顯示出目前的 PATH：

![alt text](image-4.png)

> 由於 /bin 的連結檔是 /usr/bin，所以普通使用者與 root 都能使用到 ls 指令。

**例題**

假設你是root，如果你將 ls 從 /bin/ls 移動到 /root/ls (可用『mv /bin/ls /root』指令達成)，然後你自己本身也在/root目錄下， 請問：

(1)你能不能直接輸入 ls 來執行？

(2)若不能，你該如何執行 ls 這個指令？

(3)若要直接輸入 ls 即可執行，又該如何進行？

Ans：

* 先用 su - 確保現在是 root，然後將 ls 移動到 /root 目錄下：
```bash
mv /bin/ls /root
```

* (1) 的答案是「不能」，因為 /root 不在 PATH 中，可以自行測試看看。

* (2) 的答案是：只能透過用絕對路徑 or 相對路徑來執行：
```bash
cd /tmp
/root/ls
```
或是：

```bash
cd /root
./ls
```

* (3) 的答案是：既然 PATH 沒有設定 /root，那就直接將 /root 加入 PATH 中即可：

```bash
PATH="${PATH}:/root"
```
> 這樣就可以直接輸入 ls 來執行了，可自行測試看看。

---
**補充**：

「${PATH}」等同於「$PATH」，不過為了分開後面加入的 `:root` 才用大括號包起來。測試看看：

```bash
x=123
echo $x
echo ${x}
x="${x}456"
echo $x
```

***

最後要記得恢復原狀，將 ls 移回 /bin：
```bash
mv /root/ls /bin
```
> 某些情況下，即使你已經將 ls 搬回 /bin 了，不過系統還是會告知你無法處理 /root/ls。這可能是因為指令參數被快取的關係。 不要緊張，只要登出 (exit) 再登入 (su -) 就可以繼續快樂的使用 ls 了！

其他例題：

![alt text](image-6.png)


![alt text](image-5.png)

PATH 的結論：

* 不同身份使用者預設的PATH不同，預設能隨意執行的指令也不同(如root與dmtsai)；

* PATH是可以修改的；

* 使用絕對路徑或相對路徑直接指定某個指令的檔名來執行，會比搜尋PATH來的正確；

* 指令應該要放置到正確的目錄下，執行才會比較方便；

* 本目錄(.)最好不要放到PATH當中。為了安全起見。


### 目錄的特殊符號

| 符號 | 說明 |
| --- | --- |
| . | 代表目前目錄 |
| .. | 代表上一層目錄 |
| ~ | 代表家目錄 |
| - | 代表前一個工作目錄 |
| ~user | 代表 user 的家目錄 |

> 工作目錄：你現在所在的目錄，可以用 pwd 查看。

### 切換目錄 --- cd

![alt text](image.png)

* 登入Linux系統後，每個帳號都會在自己帳號的家目錄中。

* 利用「相對路徑」的前提：必須確認你目前的路徑才能正確使用。例如上表當中最後一個例子， 你必須要確認你是在/var/spool/mail當中，並且知道在/var/spool當中有個 postfix 的目錄才行，這樣才能使用cd ../postfix 去到正確的目錄說，否則就要直接輸入cd /var/spool/postfix。

* 使用『 cd ~ 』可以回到個人的家目錄。另外，如果僅輸入「cd」時，代表的就是『 cd ~ 』，同樣會回到自己的家目錄。

* 『 cd - 』比較難以理解，請自行多做幾次練習，就會比較明白了：

```bash
cd /etc
cd /tmp
cd -  # 回到 /etc
```

### 顯示當前的工作目錄 --- pwd

![alt text](image-1.png)

* 重點是那個「-P」(注意是大寫)參數。這個參數是用來顯示實際的目錄位置，而不是使用連結檔案的位置。

### 建立新目錄 --- mkdir

![alt text](image-2.png)

如果在最後一個範例沒加上 -m 會怎樣？要知道預設的目錄權限，得先了解甚麼是 umask。可以先參考[底下的介紹](#umask)。


### 刪除「空的」目錄 --- rmdir

![alt text](image-3.png)

* rmdir 只能刪除空的目錄，如果想要強制刪除整個目錄(連同目錄內的檔案)，可以使用 rm -r：

```bash
mkdir -p /tmp/test/test2
echo "Hello" > /tmp/test/test2/test.txt
rm -r /tmp/test
```

## 檔案與目錄管理

### 檢視檔案與目錄 --- ls

![alt text](image-7.png)

### umask